<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>الترجمة الفورية لأي فيديو</title>
<style>
body{background:#0b0f19;color:#e5e7eb;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Naskh Arabic UI",sans-serif}
.wrap{max-width:960px;margin:24px auto;padding:18px;background:#121826;border-radius:16px}
.row{display:flex;gap:10px;flex-wrap:wrap}
input[type=url]{flex:1;min-width:240px;padding:12px 14px;border-radius:12px;border:none;background:#0f1421;color:#fff}
button{padding:12px 16px;border-radius:12px;border:none;background:#7c3aed;color:#fff;font-weight:700;cursor:pointer}
button:hover{background:#6d28d9}
.muted{color:#98a2b3}
#output{margin-top:20px;white-space:pre-wrap;line-height:1.8}
</style>
</head>
<body>
<div class="wrap">
  <h1>🎧 الترجمة الفورية لأي فيديو</h1>
  <p class="muted">ألصق رابط الفيديو (YouTube / TikTok / Twitter / MP4) ثم اضغط "ابدأ".</p>
  <form class="row" onsubmit="start(event)">
    <input id="url" type="url" placeholder="https://..." required/>
    <button>ابدأ</button>
  </form>
  <div id="status" class="muted"></div>
  <div id="output"></div>
</div>

<script>
async function start(e){
  e.preventDefault();
  const url=document.getElementById('url').value.trim();
  const status=document.getElementById('status');
  const out=document.getElementById('output');
  status.textContent='⏳ جاري تحميل الفيديو...';
  out.textContent='';
  try{
    const res=await fetch('/api/full_translate',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({url})
    });
    const data=await res.json();
    if(!data.ok){status.textContent='❌ فشل التحميل أو التفريغ';return;}
    status.textContent='✅ تمت الترجمة';
    out.textContent=data.text_ar;
  }catch(err){
    status.textContent='❌ خطأ: '+err.message;
  }
}
</script>
</body>
</html>
